# 📝9장 단위 테스트

## TDD 법칙 세 가지

- 첫째 법칙: 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
- 둘째 법칙: 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
- 셋째 법칙: 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

## 깨끗한 테스트 유지하기

테스트 코드는 작성만 하면 괜찮은 것이 아니다. 테스트 코드를 일반 비즈니스 로직을 작성하는 것처럼 클린하게 작성할 수 있도록 노력 해야 한다. 시간이 지나 요구사항이 변경되면 테스트 코드 또한 유지보수가 들어간다. 이때 마구잡이로 테스트 코드를 작성해 두었다면 나중에 유지보수하기 무척 힘들어질 수 있고 자칫 테스트 코드를 작성하지 않는 것 만 못할 수 있다.

## 테스트는 유연성, 유지보수성, 재사용성을 제공한다.

코드에 유연성, 유지보수성, 재사용성을 제공하는 버팀목이 바로 단위 테스트다. 아키텍처가 부실한 코드나 설계가 모호하고 엉망인 코드라도 별다른 우려 없이 변경할 수 있다. 따라서 테스트 코드가 지저분하면 코드를 변경하는 능력이 떨어지며 코드 구조를 개선하는 능력도 떨어진다.

## 깨끗한 테스트 코드

테스트 코드는 가독성이 중요하다. 테스트 코드는 최소의 표현으로 많은 것을 나타내야 한다.

BUILD-OPERATE-CHECK 패턴 첫 부분은 테스트 자료를 만든다. 두 번째 부분은 테스트 자료를 조작하며, 세 번째 부분은 조작한 결과가 올바른지 확인한다. 위와 같은 패턴은 잡다한 코드를 없애고 테스트 코드는 본론에 돌입해 진짜 필요한 자료 유형과 함수만 사용한다. 

## 이중 표준

테스트 API 코드에 적용하는 표준은 실제 코드에 적용하는 표준과 확실히 다르다. 단순하고, 간결하고, 표현력이 풍부해야 하지만, 실제 코드만큼 효율적일 필요는 없다. 단순하고, 간결하고, 표현력이 풍부해야 하지만, 실제 코드만큼 효율적일 필요는 없다. 실제 환경이 아니라 테스트 환경에서 돌아가는 코드이기 때문이다.

## 테스트 당 assert 하나

assert 문이 단 하나인 함수는 결론이 하나라서 코드를 이해하기 쉽고 빠르다. 하지만 assert 문을 하나만 사용하려 할 경우 중복되는 코드가 많아질 수 있고 시간이 많이 들 수 있다. 중복되는 코드가 많아질 경우 TEMPALTE METHOD 패턴을 사용하면 중복을 제거할 수 있다. assert 문 개수는 반드시 하나일 필요는 없지만 최대한 개수를 줄여야 한다.

## 테스트 당 개념 하나

한 테스트 메소드에 개념이 여러개일 경우 장황한 테스트 코드 속에서 다른 개발자가 테스트 코드를 이해하는데 시간이 오래 걸리게 된다. 따라서 테스트당 개념은 하나로 한다.

## F.I.R.S.T

빠르게: 테스트 코드는 초반에는 빠르게 자주 돌려야 하기 때문에 빨라야한다.

독립적으로: 각 테스트는 서로 의존하면 안된다. 각 테스트는 어떤 순서여도 실행되어야 한다.

반복가능하게: 테스트는 어떤 환경에서도 반복 가능해야 한다.

자가검증하는:  테스트는 부울(bool) 값으로 결과를 내야한다.

적시에: 단위 테스트는 테스트하려는 실제 코드를 구현하기 직전에 구현한다. 실제 코드를 구현한 다음에 테스트 코드를 만들면 실제 코드가 테스트하기 어렵다는 사실을 발견할지 모른다.
