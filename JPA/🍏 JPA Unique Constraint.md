# ğŸÂ JPA Unique Constraint ì‚¬ìš©í•˜ê¸°

ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ì¤‘ë³µëœ ê°’ ì…ë ¥ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œë‹¤.

 ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜ì—ëŠ” 2ê°€ì§€ê°€ ìˆë‹¤.

- @Column(unique=true)
- @UniqueConstraint

ì²«ë²ˆì§¸ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œëŠ” í•˜ë‚˜ì˜ ì»¬ëŸ¼ì— ëŒ€í•´ì„œ ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ì„ ë‘ë²ˆì§¸ëŠ” ì—¬ëŸ¬ ì»¬ëŸ¼ì— ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ ìˆ˜ ìˆë‹¤.

## ê¸°ë³¸ í‚¤ì™€ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì˜ ì°¨ì´ì ì€?

Unique Constraintë¥¼ ì‚¬ìš©í•˜ë©´ ì—´ ë˜ëŠ” ì—´ ì¡°í•©ì˜ ë°ì´í„°ê°€ ê° í–‰ì— ëŒ€í•´ì„œ ê³ ìœ í•˜ë‹¤. ê¸°ë³¸ í‚¤ ë˜í•œ ê° í–‰ì— ëŒ€í•˜ì—¬ ê³ ìœ í•œ ì œì•½ ì¡°ê±´ì´ ìˆë‹¤. ê¸°ë³¸ í‚¤ ì œì•½ ì¡°ê±´ì€ ê° í…Œì´ë¸”ë§ˆë‹¤ í•˜ë‚˜ì˜ ì—´ì— ëŒ€í•´ì„œë§Œ ì¡°ê±´ì„ ê°€ì§ˆ ìˆ˜ ìˆì§€ë§Œ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì€ ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. 

ìš°ë¦¬ê°€ ë§Œë“œëŠ” ì œì•½ ì¡°ê±´ì€ í…Œì´ë¸”ì„ ìƒì„±í•  ë•Œë‚˜ insert, update, deleteë¥¼ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.

## ì‹±ê¸€ ì»¬ëŸ¼ ê·¸ë¦¬ê³  ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ ì¬ì•½ ì¡°ê±´ì´ë€ ë¬´ì—‡ì¸ê°€?

unique constraintsëŠ” ì—´ ì œì•½ ì¡°ê±´ ë˜ëŠ” í…Œì´ë¸” ì œì•½ ì¡°ê±´ì¼ ìˆ˜ ìˆë‹¤. í…Œì´ë¸” ë ˆë²¨ì—ì„œ ì—¬ëŸ¬ê°œ ì»¬ëŸ¼ ì œì•½ ì¡°ê±´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

- ì»¬ëŸ¼ ë ˆë²¨ ì œì•½ì¡°ê±´ì€ í•œê°œì˜ ì»¬ëŸ¼ì— ì ìš©ëœë‹¤.
- í…Œì´ë¸” ë ˆë²¨ì˜ ì œì•½ ì¡°ê±´ì€ ì „ì²´ í…Œì´ë¸”ì— ì ìš©ëœë‹¤.

## í…Œì´ë¸” ì œì•½ì¡°ê±´

ë³µí•© ìœ ë‹ˆí¬ í‚¤ë€ ì»¬ëŸ¼ì˜ ì¡°í•©ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ìœ ë‹ˆí¬ í‚¤ë‹¤. ë³µí•© ìœ ë‹ˆí¬ í‚¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ì œì•½ì¡°ê±´ì„ ì»¬ëŸ¼ ëŒ€ì‹  í…Œì´ë¸”ì— ì ìš©í•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ëŠ” @UniqueConstraint annotationì„ ì‚¬ìš©í•´ì„œ ì´ë¥¼ ì ìš© ì‹œí‚¬ ìˆ˜ ìˆë‹¤. 

Unique Constraint ì€ DDLì— í¬í•¨ ë˜ì–´ì•¼ ëœë‹¤.

> @Target(value={})
@Retention(value=RUNTIME)
> 
> 
> **public**
> 
> @interface UniqueConstraint {
>     String **name**() **default** "";
>     String[] columnNames();
> }
> 

ìœ„ì˜ UniqueConstraint ì–´ë…¸í…Œì´ì…˜ì˜ êµ¬ì„±ì„ ì‚´í´ë³´ë©´ columnNamesë¼ëŠ” ë¬¸ìì—´ ë°°ì—´ì´ ìˆë‹¤. í•´ë‹¹ ë°°ì—´ì—

ë³µí•© ìœ ë‹ˆí¬ í‚¤ë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ì»¬ëŸ¼ ì´ë¦„ì˜ ë¬¸ìì—´ì„ ë„£ìœ¼ë©´ ëœë‹¤. ì‚¬ìš©ì€ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

> @Table(uniqueConstraints = { @UniqueConstraint(columnNames = { "personNumber", "isActive" }) })
> 

ìœ„ì™€ ê°™ì´ ì‚¬ìš©í•´ë„ ìƒê´€ì€ ì—†ì§€ë§Œ ìœ„ì™€ ê°™ì´ UniqueConstraintì˜ íŒŒë¼ë¯¸í„°ì¤‘ nameì— ê°’ì„ ë„£ì§€ ì•Šìœ¼ë©´ ê°’ì´ ì•„ë˜ì™€ ê°™ì´ provider-generated valueê°€ ë˜ë²„ë¦°ë‹¤.

 

> [main] DEBUG org.hibernate.SQL -
    alter table Person add constraint UK5e0bv5arhh7jjhsls27bmqp4a
> 
> 
> **unique**
> 
> (personNumber, isActive)
> 

í•´ë‹¹ ë¶€ë¶„ì´ ê±°ìŠ¬ë¦¬ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

> @Table(uniqueConstraints = { @UniqueConstraint(name = "UniqueNumberAndStatus", columnNames = { "personNumber", "isActive" }) })
> 

## í•˜ë‚˜ì˜ ì—”í‹°í‹°ì— ì—¬ëŸ¬ê°œì˜ ë³µí•© ìœ ë‹ˆí¬í‚¤ ì‚¬ìš©í•˜ê¸°

í…Œì´ë¸”ì€ ë³µí•© ìœ ë‹ˆí¬ í‚¤ë¥¼ ì—¬ëŸ¬ê°œ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ì‚¬ìš©ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.

> @Table(uniqueConstraints = {
@UniqueConstraint(name = "UniqueNumberAndStatus", columnNames = {"personNumber", "isActive"}),
@UniqueConstraint(name = "UniqueSecurityAndDepartment", columnNames = {"securityNumber", "departmentCode"})})
> 

## ì •ë¦¬

Unique constraintë¥¼ ì‚¬ìš©í•´ì„œ ë‘ ê°œ ì´ìƒì˜ í–‰ì´ ì—´ ë˜ëŠ” ì—´ ì§‘í•©ì—ì„œ ë™ì¼í•œ ê°’ì„ ê°€ì§ˆ ìˆ˜ ì—†ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

ì°¸ì¡°

[https://www.baeldung.com/jpa-unique-constraints](https://www.baeldung.com/jpa-unique-constraints)